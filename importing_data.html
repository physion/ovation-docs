<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Selected Data Importers &mdash; Ovation Scientific Data Management System 2.0 Beta documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0 Beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Ovation Scientific Data Management System 2.0 Beta documentation" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><img src="_static/ovation_logo.png">
          Ovation</a>
        <span class="navbar-text navbar-version pull-left"><b>2.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://ovation.io">Dashboard</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Topics <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="about_ovation.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="workflow_guide.html">Ovation Workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="workflow_guide.html#import-files">1. Import files</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_guide.html#use-files-in-your-existing-pipeline">2. Use files in your existing pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_guide.html#import-results-as-analysis-records">3. Import results as Analysis Records</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="source_guide.html">Sources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="source_guide.html#metadata">Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="source_guide.html#derived-sources">Derived Sources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="procedure_guide.html">Protocols and Procedures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="procedure_guide.html#making-measurements">Making Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="procedure_guide.html#source-derivation">Source derivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="procedure_guide.html#analysis-records">Analysis Records</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="analysis_records_guide.html">Analysis Records</a></li>
<li class="toctree-l1"><a class="reference internal" href="tabular_data.html">Importing and analyzing tabular (CSV) data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tabular_data.html#importing-tabular-csv-data">Importing tabular (CSV) data</a></li>
<li class="toctree-l2"><a class="reference internal" href="tabular_data.html#retrieving-tabular-csv-data">Retrieving tabular (CSV) data</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="using_rovation.html">R</a><ul>
<li class="toctree-l2"><a class="reference internal" href="using_rovation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_rovation.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_rovation.html#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="using_ovation_python.html">Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="using_ovation_python.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_ovation_python.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_ovation_python.html#usage">Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="using_ovation_matlab.html">Matlab</a><ul>
<li class="toctree-l2"><a class="reference internal" href="using_ovation_matlab.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_ovation_matlab.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_ovation_matlab.html#usage">Usage</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="selected-data-importers">
<h1>Selected Data Importers<a class="headerlink" href="#selected-data-importers" title="Permalink to this headline">¶</a></h1>
<p>This page describes usage of selected Ovation data import plugins.</p>
<div class="section" id="fenton-lab-dat-data">
<h2>Fenton Lab .dat Data<a class="headerlink" href="#fenton-lab-dat-data" title="Permalink to this headline">¶</a></h2>
<p>The Fenton Lab dat import script is a trio of Matlab functions. The top-level function is <cite>import_fenton_dat</cite>. The <cite>import_fenton_dat</cite> script requires the <em class="xref std std-ref">Ovation Matlab API</em>.</p>
<ol class="arabic">
<li><p class="first">Add a Project and Experiment to the databse (if needed)</p>
</li>
<li><p class="first">Set the Experiment equipment setup (this only needs to be done once per experiment):</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt; exp = context.getObjectWithURI(&#39;&lt;pasted URI from Ovation application&#39;&gt;);
&gt;&gt; exp.setEquipmentSetup(config2map(&#39;&lt;cfg file&gt;&#39;, &#39;Arena&#39;));
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may choose a different equipment prefix than <cite>Arena</cite> if you choose. Whatever you choose, you&#8217;ll need to use the same name later when calling <cite>import_fenton_dat</cite></p>
</div>
<ol class="arabic" start="3">
<li><p class="first">Create an EpochGroup within the new Experiment for the behavioral data</p>
</li>
<li><p class="first">Retrieve a reference to the <cite>EpochGroup</cite>, <cite>Source</cite> and <cite>Protocol</cite> for the data. You can browse from the <cite>DataContext</cite> in Matlab or copy-and-paste from the Ovation application, using <cite>getObjectWithURI</cite> from the Matlab <cite>DataContext</cite>, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt; source = context.getObjectWithURI(&#39;&lt;pasted URI from Ovation application&gt;&#39;);
&gt;&gt; protocol = context.getObjectWithURI(&#39;&lt;pasted URI from Ovation application Protocols View&gt;&#39;);
&gt;&gt; epochGroup = context.getObjectWithURI(&#39;&lt;pasted URI from Ovation application&gt;&#39;);
</pre></div>
</div>
</li>
</ol>
<ol class="arabic" start="4">
<li><p class="first">Import the room-frame and arena-frame .dat and image files. This example shows an import of the <cite>bl1D1Hab</cite> trial:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt; epoch = import_fenton_dat(source, epochGroup, protocol, &#39;Arena&#39;, &#39;Arena.Camera&#39;, &#39;America/New_York&#39;, 600, &#39;bl1D1Hab_Arena.dat&#39;, fullfile(pwd(), &#39;bl1D1Hab_Arena.png&#39;), &#39;bl1D1Hab_Room.dat&#39;, fullfile(pwd(), &#39;bl1D1Hab_Room.png&#39;), &#39;image/png&#39;)
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You must provide the <em>abolute</em> path (i.e. from the file-system root) to the image files. Because Matlab does not change the JVM&#8217;s working directory when changing Matlab working directories, there is no way to calculate the absolute path in code. You can use <cite>fullfile(pwd(), &lt;relative path&gt;)</cite> to create an absolute path.</p>
</div>
<ol class="arabic" start="6">
<li><p class="first">Additional table (e.g. CSV) data can be imported using the &#8220;Insert Measurement...&#8221; wizard in the Ovation application:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt; epoch.insertMeasurement(&#39;&lt;table name&gt;&#39;, ...
    array2set({&#39;subject&#39;}), ...
    array2set({&#39;Arena&#39;}), ...
    java.util.File(&#39;&lt;absolute path to .csv&gt;&#39;).toURI().toURL(), ...
    &#39;application/csv&#39;... % or other appropriate content type
    )
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="pclamp">
<h2>pClamp<a class="headerlink" href="#pclamp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="axon-binary-format-abf">
<h3>Axon Binary Format (.abf)<a class="headerlink" href="#axon-binary-format-abf" title="Permalink to this headline">¶</a></h3>
<p>The Ovation pClamp (ABF) importer is a command-line tool</p>
<ol class="arabic">
<li><p class="first">If needed, install Python 2.7 (download from <a class="reference external" href="http://python.org">http://python.org</a>)</p>
</li>
<li><p class="first">If needed, install the Python <cite>setuptools</cite> package. Download and run <a class="reference external" href="http://peak.telecommunity.com/dist/ez_setup.py">ez_setup.py</a>:</p>
<div class="highlight-python"><div class="highlight"><pre>python ez_setup.py
</pre></div>
</div>
</li>
<li><p class="first">Install the <em class="xref std std-ref">Ovation Python API</em> and the Ovation Neo Importer:</p>
<div class="highlight-python"><div class="highlight"><pre>easy_install ovation-neo
</pre></div>
</div>
</li>
</ol>
<p>The physiology data importer is run from the terminal command line:</p>
<div class="highlight-python"><div class="highlight"><pre>python -m ovation_neo --timezone &lt;time zone ID&gt; --container &lt;experiment URI&gt; --protocol &lt;protocol URI&gt; --source &lt;source URI&gt; file1.abf file2.plx...
</pre></div>
</div>
<p>You can get more information about the available arguments by running:</p>
<div class="highlight-python"><div class="highlight"><pre>python -m ovation_neo -h
</pre></div>
</div>
<p>To find the <cite>Experiment</cite>, <cite>Protocol</cite> and <cite>Source</cite> URIs, you can copy-and-paste the relevant object(s) from the Ovation application or call the <cite>getURI())</cite> method on the object within Python.</p>
</div>
<div class="section" id="clampfit-atf">
<h3>Clampfit (.atf)<a class="headerlink" href="#clampfit-atf" title="Permalink to this headline">¶</a></h3>
<p>Post-experiment analysis are stored as <cite>AnalysisRecords</cite> in Ovation. These instructions describe adding an <cite>AnalysisRecord</cite> with a single Clampfi analysis as the analysis output.</p>
<ol class="arabic simple">
<li>Export the analysis from Clampfit as an <cite>.atf</cite> file. The <cite>.atf</cite> format is really tab-delimited text</li>
<li>Open the .atf file in Excel and re-save as Comma-separated value (CSV)</li>
<li>In the Ovation application, select the <cite>Project</cite> containing the raw traces used in the analysis. Right-click on this <cite>Project</cite> and select &#8220;Insert Analysis Record...&#8221;</li>
<li>Enter the name for the new <cite>AnalysisRecord</cite>. We recommend that you choose a descriptive name such as the subject&#8217;s ID or the &#8220;name&#8221; of the cell that you recorded.</li>
</ol>
<div class="figure">
<img alt="_images/add-atf-analysis-record1.png" src="_images/add-atf-analysis-record1.png" />
<p class="caption">Insert a new <cite>AnalysisRecord</cite> to hold the Clampfit analysis</p>
</div>
<ol class="arabic simple" start="5">
<li>Select the <cite>Protocol</cite> for this <cite>AnalysisRecord</cite>.</li>
</ol>
<div class="figure">
<img alt="_images/add-atf-analysis-record1.png" src="_images/add-atf-analysis-record1.png" />
<p class="caption">Select the <cite>Protocol</cite> for the Clampfit analysis. You can create a new <cite>Protocol</cite> by entering the name of the new protocol and pressing the &#8220;+&#8221; button. If there are &#8220;variables&#8221; in the protocol that are set for each analysis, surround the variable name with curly braces (<cite>{</cite> and <cite>}</cite>) in the protocol document. For example, the a variable describing a detection threshold might be annotated as <cite>{THRESHOLD_mV}</cite> in the protocol document.</p>
</div>
<ol class="arabic simple" start="6">
<li>Enter any protocol parameters for this analysis (i.e. values for any variables in the protocol document)</li>
</ol>
<div class="figure">
<img alt="_images/add-atf-analysisrecord3.png" src="_images/add-atf-analysisrecord3.png" />
<p class="caption">Enter protocol parameters for the analysis. For each variable in the analysis&#8217; protocol document (e.g. <cite>{THRESHOLD_mV}</cite>), you should enter a value here (e.g. key = <cite>THRESHOLD_mV</cite>, value = <cite>1</cite>).</p>
</div>
<ol class="arabic simple" start="7">
<li>Select the <cite>Measurements</cite> that were used in this analysis. From the Project browser, select the <cite>EpochGroup</cite> imported from the corresponding pClamp <cite>.abf</cite> file and press the &#8220;+&#8221; button to add <cite>Measurements</cite> from this <cite>EpochGroup</cite> to the <cite>AnalysisRecord</cite>. Press the &#8220;Finish Button&#8221; to add the Analysis Record.</li>
</ol>
<div class="figure">
<img alt="_images/add-atf-analysisrecord4.png" src="_images/add-atf-analysisrecord4.png" />
<p class="caption">Select the <cite>EpochGroup</cite> imported from the corresponding pClamp <cite>.abf</cite> file and press the &#8220;+&#8221; button to add <cite>Measurements</cite> from this <cite>EpochGroup</cite> to the <cite>AnalysisRecord</cite>.</p>
</div>
<ol class="arabic simple" start="8">
<li>Right-click on the newly inserted Analsys Record in the Project Navigator and select &#8220;Insert Analysis Output...&#8221;. In the wizard, press the &#8221;...&#8221; button and locate the CSV file generated in step 2 above. Note that we&#8217;ve entered &#8220;application/csv&#8221; for the &#8220;Content Type&#8221; of this analysis output. Press the &#8220;Finish&#8221; button to add the analysis output to the Analysis Record.</li>
<li>You can view the calculated slopes in the Ovation application data viewer (as well as open them in Excel) by selecting the analysis output (or the entire Analysis Record) in the Ovation Project Navigator.</li>
</ol>
<div class="figure">
<img alt="_images/atf-analysis-record.png" src="_images/atf-analysis-record.png" />
<p class="caption">Select the newly inserted analsyis output (e.g. &#8220;slope.csv&#8221;) or the entire Analysis Record to display the analysis results.</p>
</div>
</div>
</div>
<div class="section" id="import-csv-via-the-r-api">
<h2>Import CSV via the R API<a class="headerlink" href="#import-csv-via-the-r-api" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Install the <a class="reference external" href="http://ovation.io/downloads">Rovation package</a>.</li>
</ol>
<div class="figure">
<img alt="_images/r_studio_install_package.png" src="_images/r_studio_install_package.png" />
<p class="caption">Rstudio package installation window. Select Install From &#8220;Package Archive&#8221;, then choose the path to the Rovation package downloaded from <a class="reference external" href="http://ovation.io">http://ovation.io</a>. Click &#8220;Install&#8221; to install <cite>Rovation</cite>.</p>
</div>
<ol class="arabic" start="2">
<li><p class="first">Load the <cite>Rovation</cite> library within R:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt; library(Rovation)
</pre></div>
</div>
</li>
<li><p class="first">Follow the example import making use of the R API and the Ovation application:</p>
<div class="highlight-python"><div class="highlight"><pre>## Connect to the database
context &lt;- NewDataContext(&quot;&lt;registered email&gt;&quot;)

## Create a new Protocol
protocol &lt;- context$insertProtocol(&quot;R protocol&quot;, &quot;... my protocol document ...&quot;)

## Or a protocol load one via URI
protocol &lt;- context$getObjectWithURI(&#39;&lt;URI copied from Ovation application&gt;&#39;)

## Get a reference to a Source and Epoch container (e.g. an EpochGroup) by copy-and-paste from the Ovation application

source &lt;- context$getObjectWithURI(&#39;&lt;source URI&gt;&#39;)
epochGroup &lt;- context$getObjectWithURI(&#39;&lt;epochGroup URI&gt;&#39;)

## Insert a new Epoch
protocolParameters &lt;- list(param1 = &quot;value1&quot;, param2 = 3, param3 = &quot;some text&quot;)
deviceParameters &lt;- list() # Add device parameters here
inputSources = list(subject=source) # Map of input sources
outputSources - list() # No new sources generated by this Epoch
epoch &lt;- epochGroup$insertEpoch(List2Map(inputSources),
                                List2Map(outputSources),
                                Datetime(year=2013, month=7, day=6),
                                Datetime(year=2013, month=7, day=7),
                                protocol,
                                List2Map(protocolParameters),
                                List2Map(deviceParameters))

## Add a CSV measurement
measurement &lt;- epoch$insertMeasurement(&quot;&lt;measurement name&gt;&quot;,
                                       Vector2Set(c(&quot;subject&quot;)), # Note same name as inputSources above
                                       Vector2Set(c(&quot;device1&quot;, &quot;device2&quot;)), # Device(s) used to make measurement. Should be present (or added) in Experiment$getEquipmentSetup
                                       NewUrl(&quot;&lt;/path/to/example.csv&gt;&quot;),
                                       &quot;application/csv&quot;
                                       )

# Wait (up to 10 minutes) for all uploads to finish
WaitForPendingUploads(context, timeout.seconds = 600)


## Retrieve the DataFrame from measurement
# The pattern for downloading (if ncessary) and accessing the local cached copy of measurement&#39;s data
localFilePath &lt;- measurement$getLocalDataPath()$get()

df &lt;- read.csv(localFilePath)
</pre></div>
</div>
</li>
</ol>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013-2014, Physion LLC.<br/>
      Last updated on Mar 24, 2014.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>